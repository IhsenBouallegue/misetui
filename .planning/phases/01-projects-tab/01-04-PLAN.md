---
phase: 01-projects-tab
plan: 04
type: execute
wave: 4
depends_on:
  - 01-03
files_modified: []
autonomous: false
requirements:
  - PROJ-01
  - PROJ-02
  - PROJ-03
  - PROJ-04
  - PROJ-05
  - PROJ-06
  - PROJ-07

must_haves:
  truths:
    - "User sees Projects tab in sidebar between Config and Doctor"
    - "Project list shows name, path, tool count, and colored health badge"
    - "Enter on a project shows per-tool breakdown with required vs installed versions"
    - "i triggers mise install in the selected project directory with Progress popup"
    - "u triggers mise upgrade in the selected project directory with Progress popup"
    - "/ activates fuzzy search filtering project names and paths"
    - "r rescans all configured directories and refreshes the project list"
    - "Defaults apply when ~/.config/misetui/config.toml does not exist"
  artifacts:
    - path: "src/config.rs"
      provides: "MisetuiConfig with load() returning defaults"
      contains: "pub struct MisetuiConfig"
    - path: "src/model.rs"
      provides: "MiseProject, ProjectToolHealth, ProjectHealthStatus"
      contains: "pub struct MiseProject"
    - path: "src/ui/projects.rs"
      provides: "Projects tab list + drill-down renderer"
      contains: "pub fn render"
    - path: "src/app.rs"
      provides: "Tab::Projects wired into App with all state fields"
      contains: "Tab::Projects"
  key_links:
    - from: "src/ui/projects.rs"
      to: "app.filtered_projects"
      via: "app.filtered_projects.iter() mapping to app.projects[idx]"
      pattern: "filtered_projects"
    - from: "src/app.rs handle_action(InstallProjectTools)"
      to: "mise::install_project_tools(path)"
      via: "tokio::spawn + OperationComplete/OperationFailed channel"
      pattern: "install_project_tools"
---

<objective>
Human verification of the complete Projects tab feature across all 7 requirements.

Purpose: Automated tests do not exist for this TUI (the codebase has no test files). All 7 PROJ requirements require visual and interactive verification by a human operator.

Output: Confirmed that all phase success criteria are TRUE, or a list of issues to address.
</objective>

<execution_context>
@/home/ihsen/.claude/get-shit-done/workflows/execute-plan.md
@/home/ihsen/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/REQUIREMENTS.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Verify: Complete Projects tab — all PROJ-01 through PROJ-07</name>
  <files>N/A — verification only, no files modified</files>
  <action>
    Run `cargo run` and manually verify all 7 PROJ requirements as described in how-to-verify.

    What was built across plans 01-03:
    - Plan 01: Config loader (src/config.rs), health model types (src/model.rs), project scanner (src/mise.rs scan_projects)
    - Plan 02: Tab::Projects in App state, action wiring, start_fetch() integration, i/u/r/search keybindings
    - Plan 03: src/ui/projects.rs renderer with list view, drill-down view, search bar, health badges

    Steps to verify:

    **PROJ-01 — Project health dashboard:**
    1. Navigate to the Projects tab in the sidebar (between Config and Doctor)
    2. Confirm the list shows projects with: Name, Path (truncated), Tools (count), Health (colored badge)
    3. Confirm the health badge colors: green for healthy, yellow for outdated, red for missing, muted for no config
    4. Expected: Any directory containing a .mise.toml within the default scan paths (~/projects, CWD) appears

    **PROJ-02 — Config file and defaults:**
    5. Confirm app starts without error even when ~/.config/misetui/config.toml does NOT exist
    6. Optionally create ~/.config/misetui/config.toml with:
       ```toml
       scan_dirs = ["/tmp/test-projects"]
       max_depth = 2
       ```
       Create /tmp/test-projects/myapp/.mise.toml with:
       ```toml
       [tools]
       node = "20"
       ```
       Restart app and confirm myapp appears in Projects tab

    **PROJ-03 — Per-tool drill-down:**
    7. Navigate to Projects tab, select a project with tools, press Enter
    8. Confirm drill-down view shows Tool / Required / Installed / Status columns
    9. Confirm health status per tool is correct (green=installed, yellow=outdated, red=not installed)
    10. Press Enter again to return to the project list

    **PROJ-04 — Install missing tools:**
    11. Select a project with missing tools (or any project), press `i`
    12. Confirm Progress popup appears with "Installing tools in {path}..."
    13. After completion, confirm OperationComplete message appears in status bar

    **PROJ-05 — Update outdated pins:**
    14. Select any project, press `u`
    15. Confirm Progress popup appears with "Upgrading tools in {path}..."

    **PROJ-06 — Fuzzy search:**
    16. Press `/` on the Projects tab
    17. Type part of a project name or path
    18. Confirm the list filters in real-time with matched characters highlighted
    19. Press Escape or Enter to exit search

    **PROJ-07 — Rescan:**
    20. Press `r` on the Projects tab
    21. Confirm the list shows "Scanning projects..." spinner then repopulates
  </action>
  <verify>
    <automated>cargo build 2>&1 | grep -E "^error" | head -5</automated>
    <manual>Run `cargo run` and follow the 21-step verification checklist above covering PROJ-01 through PROJ-07. Type "approved" when all checks pass or describe failures.</manual>
  </verify>
  <done>Human operator has typed "approved" confirming all 7 PROJ requirements are satisfied in the running application.</done>
</task>

</tasks>

<verification>
Human approval that all PROJ-01 through PROJ-07 requirements are visually and interactively satisfied.
</verification>

<success_criteria>
All 7 PROJ requirements verified by human operator:
- PROJ-01: Project list visible with name/path/tool count/health
- PROJ-02: Config defaults work; custom config changes scan dirs
- PROJ-03: Drill-down shows per-tool required vs installed with health
- PROJ-04: i triggers install with Progress popup
- PROJ-05: u triggers upgrade with Progress popup
- PROJ-06: / fuzzy-searches project names and paths
- PROJ-07: r rescans and refreshes project list
</success_criteria>

<output>
After completion, create `.planning/phases/01-projects-tab/01-04-SUMMARY.md` following the summary template.
</output>
